# Sprint S07 — Customer Feedback Sprint

> **Phase**: 2 (客戶回饋改善)
> **狀態**: 完成

## 目標

Phase 1 完成後，客戶實際使用回饋 6 個問題，在此 Sprint 中全部解決。

## 完成項目

### Task 1: 隱藏多餘的 Sidebar 導航
- `components/sidebar.py` 注入 CSS 隱藏 `st.navigation()` 預設導航項目

### Task 2: CRM 新增 department 欄位
- `database/schema.sql` — crm table 新增 `department TEXT`
- `models/schemas.py` — CRM model 新增 `department`
- `services/crm.py` — create/update 新增 `department` 參數
- `pages/crm.py` — 表單新增 department 輸入
- `database/seed.py` — seed data 加入 department 值

### Task 3: Decision Maker / Champion UX 改善
- `pages/crm.py` — 列表只顯示 DM/Champion 姓名
- 新增「客戶詳情」tab，顯示完整 DM/Champion 資訊（姓名、職稱、溝通風格/備註）
- Tab 結構：客戶詳情 | 新增客戶 | 編輯客戶

### Task 4: Status Code 全面替換
- **舊系統**: S01-S04 / T01-T02 / C01-C04 / D01-D03 + LOST + HOLD (15 codes)
- **新系統**: 售前 L0-L7 + 售後 P0-P2 + LOST + HOLD (12 codes)
- 更新 `constants.py`、`schema.sql`、`models/schemas.py`、`services/project.py`
- Pipeline 頁面更新色彩映射（L 系列漸層藍 + P 系列漸層綠）

### Task 5: 售前/售後頁面拆分
- `pages/project.py` → `pages/presale.py`（售前 L0-L7）+ `pages/postsale.py`（售後 P0-P2）
- `owner` → `presale_owner` + `postsale_owner` 雙負責人
- `services/project.py` 新增 `get_presale()` / `get_postsale()` 篩選方法
- `app.py` / `components/sidebar.py` / `pages/settings.py` 更新導航

### Task 6: 更新文件
- `docs/DEVELOPMENT_PLAN.md` — 更新狀態碼、頁面架構、schema 定義
- `docs/sprints/S07.md` — 本文件
- `CLAUDE.md` — 更新架構描述

## DB Migration

需執行以下 SQL（或直接 re-seed）：
```sql
ALTER TABLE crm ADD COLUMN department TEXT;
ALTER TABLE project_list ADD COLUMN presale_owner TEXT;
ALTER TABLE project_list ADD COLUMN postsale_owner TEXT;
ALTER TABLE project_list DROP COLUMN IF EXISTS owner;
```
